"use strict";const designHeader=document.querySelector(".js_header_design"),designContent=document.querySelector(".js_content_design"),angleDesign=document.querySelector(".js_angle_design"),dataHeader=document.querySelector(".js_header_data"),dataContent=document.querySelector(".js_content_data"),angleData=document.querySelector(".js_angle_data"),shareHeader=document.querySelector(".js_header_share"),shareContent=document.querySelector(".js_content_share"),angleShare=document.querySelector(".js_angle_share"),handleClick=e=>{const t=e.currentTarget;t.classList.contains("js_header_design")?(designContent.classList.toggle("collapsed"),dataContent.classList.add("collapsed"),shareContent.classList.add("collapsed"),angleDesign.classList.toggle("rotate"),angleData.classList.add("rotate"),angleShare.classList.add("rotate")):t.classList.contains("js_header_data")?(dataContent.classList.toggle("collapsed"),designContent.classList.add("collapsed"),shareContent.classList.add("collapsed"),angleData.classList.toggle("rotate"),angleShare.classList.add("rotate"),angleDesign.classList.add("rotate")):t.classList.contains("js_header_share")&&(shareContent.classList.toggle("collapsed"),dataContent.classList.add("collapsed"),designContent.classList.add("collapsed"),angleShare.classList.toggle("rotate"),angleData.classList.add("rotate"),angleDesign.classList.add("rotate"))};designHeader.addEventListener("click",handleClick),dataHeader.addEventListener("click",handleClick),shareHeader.addEventListener("click",handleClick);const submitButton=document.querySelector(".js_submit_button"),linkCard=document.querySelector(".js_link_card"),handleClickSubmit=e=>{e.preventDefault(),linkCard.classList.remove("collapsed")};submitButton.addEventListener("click",handleClickSubmit);const fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){data.photo=fr.result,profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,localStorage.setItem("dataStorage",JSON.stringify(data))}fileField.addEventListener("change",getImage);const allInputs=document.querySelector(".js_all_inputs"),previewName=document.querySelector(".js_preview_name"),previewJob=document.querySelector(".js_preview_job"),previewEmail=document.querySelector(".js_preview_email"),previewPhone=document.querySelector(".js_preview_phone"),previewLinkedin=document.querySelector(".js_preview_linkedin"),previewGithub=document.querySelector(".js_preview_github");let data={palette:1,name:"",job:"",photo:"",email:"",phone:"",linkedin:"",github:""};const dataName=()=>{""!==data.name?previewName.innerHTML=data.name:previewName.innerHTML="Nombre Apellido"},dataJob=()=>{""!==data.job?previewJob.innerHTML=data.job:previewJob.innerHTML="Front-end developer"},dataEmail=()=>{previewEmail.href="mailto:"+data.email},dataPhone=()=>{previewPhone.href="tel:"+data.phone},dataLinkedin=()=>{if(data.linkedin.includes("https:/")){const e=/^(\w+):\/\/([^\/]+)\/([^\/]+\/)([^]+)$/.exec(data.linkedin);data.linkedin=e[4],previewLinkedin.href="https://www.linkedin.com/in/"+e[4]}if(data.linkedin.includes("www.linkedin.com/")){const e=/^([^\/]+)\/([^]+)$/.exec(data.linkedin);console.log(e),data.linkedin=e[2],previewLinkedin.href="https://www.linkedin.com/in/"+e[2]}if(data.linkedin.includes("linkedin.com/")){const e=/^([^\/]+)\/([^]+)$/.exec(data.linkedin);console.log(e),data.linkedin=e[2],previewLinkedin.href="https://www.linkedin.com/in/"+e[2]}else previewLinkedin.href="https://www.linkedin.com/in/"+data.linkedin},dataGithub=()=>{if(data.github.includes("@")&&(data.github=data.github.replace("@",""),previewGithub.href="https://github.com/"+data.github),data.github.includes("https:/")){const e=/^(\w+):\/\/([^\/]+)\/([^]+)$/.exec(data.github);data.github=e[3],previewGithub.href=e[0]}if(data.github.includes("www.github.com/")){const e=/^([^\/]+)\/([^]+)$/.exec(data.github);data.github=e[2],previewGithub.href=e[0]}if(data.github.includes("github.com/")){const e=/^([^\/]+)\/([^]+)$/.exec(data.github);console.log(e),data.github=e[2],previewGithub.href="https://"+e[0]}else previewGithub.href="https://github.com/"+data.github},previewCard=()=>{""!==data.name?previewName.innerHTML=data.name:previewName.innerHTML="Nombre Apellido",""!==data.job?previewJob.innerHTML=data.job:previewJob.innerHTML="Front-end developer",previewEmail.href="mailto:"+data.email,previewPhone.href="tel:"+data.phone,dataLinkedin(),dataGithub()},handleInput=e=>{const t=e.target.name,a=e.target.value;localStorage.setItem("dataStorage",JSON.stringify(data)),data[t]=a,previewCard()};allInputs.addEventListener("keyup",handleInput),allInputs.addEventListener("change",handleInput);const dataLS=()=>{let e=JSON.parse(localStorage.getItem("dataStorage"));return null!==e&&(data=e),data},nameInput=document.querySelector(".js_name_input"),jobInput=document.querySelector(".js_job_input"),emailInput=document.querySelector(".js_email_input"),phoneInput=document.querySelector(".js_phone_input"),linkedinInput=document.querySelector(".js_linkedin_input"),githubInput=document.querySelector(".js_github_input"),paintData=()=>{data=dataLS(),nameInput.value=""+data.name,jobInput.value=""+data.job,emailInput.value=""+data.email,phoneInput.value=""+data.phone,linkedinInput.value=""+data.linkedin,githubInput.value=""+data.github,""===data.photo?clearImage():(profileImage.style.backgroundImage=`url(${data.photo})`,profilePreview.style.backgroundImage=`url(${data.photo})`);paintPalette(parseInt(data.palette))},allPalette=document.querySelectorAll(".color-box-input"),previewContainer=document.querySelector(".js_preview_palette");function paintPalette(e){previewContainer.classList.remove("palette-1","palette-2","palette-3"),previewContainer.classList.add("palette-"+e)}function handlerRadio(e){const t=parseInt(e.currentTarget.value);data.palette=t,paintPalette(t)}paintData(),previewCard();for(const e of allPalette)e.addEventListener("click",handlerRadio);const resetButton=document.querySelector(".js_reset_button"),handleClickReset=e=>{e.preventDefault(),clearObjectData(),previewCard(),allInputs.reset(),clearImage();paintPalette(parseInt(data.palette)),clearSubmitButton(),localStorage.removeItem("dataStorage")};function clearSubmitButton(){linkCard.classList.add("collapsed"),submitButton.classList.remove("submit-button-gray")}function clearImage(){profileImage.style.backgroundImage="url()",profilePreview.style.backgroundImage="url(./assets/images/retrato-defecto.png)"}function clearObjectData(){data.palette=1,data.name="",data.job="",data.photo="",data.email="",data.phone="",data.linkedin="",data.github=""}resetButton.addEventListener("click",handleClickReset);const messageCard=document.querySelector(".js_message"),urlCard=document.querySelector(".js_url");function backgroundCreate(){submitButton.classList.add("submit-button-gray")}function handleCreateCard(e){e.preventDefault(),fetch("https://awesome-profile-cards.herokuapp.com/card",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)}).then(e=>e.json()).then(e=>{e.success?(messageCard.innerHTML="La tarjeta ha sido creada",urlCard.innerHTML=e.cardURL,urlCard.href=e.cardURL,backgroundCreate()):messageCard.innerHTML="Debes rellenar todos los campos"})}submitButton.addEventListener("click",handleCreateCard);const buttonTwitter=document.querySelector(".js_button_twitter");function handleTwitterClick(){const e=urlCard.href;buttonTwitter.href="https://twitter.com/intent/tweet?text=%C2%A1¡¡He%20creado%20mi%20propia%20tarjeta%20de%20contacto!!!%20Puedes%20verla%20aqu%C3%AD%3A&url="+e}buttonTwitter.addEventListener("click",handleTwitterClick);